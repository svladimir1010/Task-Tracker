{% extends "base.html" %}
{% block title %}Task Tracker{%endblock%}
{% block content %}
<h1 class="mt-4">Task Tracker</h1>
<div class="mb-3">
	<form method="GET" class="d-flex gap-3">
		<div>
			<label class="form-label">Filter by Status:</label>
			<select name="status" class="form-select" onchange="this.form.submit()">
				<option value="">All Statuses</option>
				<option value="Not Started" {% if status_filter=='Not Started' %}selected{% endif %}>Not Started</option>
				<option value="In Progress" {% if status_filter=='In Progress' %}selected{% endif %}>In Progress</option>
				<option value="Completed" {% if status_filter=='Completed' %}selected{% endif %}>Completed</option>
			</select>
		</div>
		<div>
			<label class="form-label">Filter by Category:</label>
			<input type="text" name="category" class="form-control" placeholder="Enter category"
			       value="{{ category_filter or '' }}">
		</div>
		<div>
			<label class="form-label">Sort by:</label>
			<select name="sort_by" class="form-select" onchange="this.form.submit()">
				<option value="id" {% if sort_by=='id' %}selected{% endif %}>Default</option>
				<option value="created_at" {% if sort_by=='created_at' %}selected{% endif %}>Data Created</option>
			</select>
		</div>
		<button type="submit" class="btn btn-sm btn-primary mt-4">Filter</button>
	</form>
</div>
<a href="{{ url_for('main.add_task') }}" class="btn btn-primary mb-3">Add New Task</a>
<ul class="list-group">
	{% for task in tasks %}
	<li class="list-group-item d-flex justify-content-between align-items-center">
		{{ task.title }} ({{ task.category }}) - {{ task.status }}
		<div>
			<a href="{{ url_for('main.edit_task', id=task.id) }}" class="btn btn-sm btn-warning me-2">
				<i class="bi bi-pencil"></i> Edit
			</a>
			<form action="{{ url_for('main.delete_task', id=task.id) }}" method="POST" style="display:inline;">
				<button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">
					<i class="bi bi-trash"></i> Delete
				</button>
			</form>
		</div>
	</li>
	{% endfor %}
</ul>
{% endblock %}

